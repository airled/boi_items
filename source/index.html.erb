<% require 'nokogiri' %>
<% require 'curb' %>
<% require_relative './handler' %>

<% URL = 'http://bindingofisaacrebirth.gamepedia.com' %>

<div class="items">
  <% html = Nokogiri::HTML(Curl.get(URL + '/Item').body) %>
  
  <div class="passive_items">
    <h2>Пассивные предметы</h2>
    <% html.xpath('//table[@class="mw-collapsible wikitable striped passive-collectible"]/tr').map do |row| %>
      <% item = get_item(row) %>
      <% next if item[:name] == '' %>
      <%= partial(:item_part, :locals => {:item => item}) %>
    <% end %>
  </div>

  <div class="active_items">
    <h2>Активные предметы</h2>
    <% html.xpath('//table[@class="mw-collapsible wikitable striped active-collectible"]/tr').map do |row| %>
      <% item = get_item(row) %>
      <% next if item[:name] == '' %>
      <%= partial(:item_part, :locals => {:item => item}) %>
    <% end %>
  </div>

</div>

<div class="trinkets">
  <h2>Брелоки</h2>
  <% html = Nokogiri::HTML(Curl.get(URL + '/Trinkets').body) %>
  <% html.xpath('//tr').map do |row| %>
    <% item = get_item(row) %>
    <% next if item[:name] == '' %>
    <%= partial(:item_part, :locals => {:item => item}) %>
  <% end %>
</div>
